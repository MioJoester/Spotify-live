<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spotify Widget</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background: #121212; margin: 0; font-family: sans-serif; }
  </style>
</head>
<body class="text-white p-4 text-sm">
  <div id="container" class="flex items-center space-x-4">
    <img id="art" src="" class="w-20 h-20 object-cover rounded-md shadow" />
    <div class="flex-1">
      <div id="track" class="font-semibold text-white truncate">Loading...</div>
      <div id="artist" class="text-gray-400 text-sm truncate"></div>
      <div id="state" class="text-xs mt-1 text-green-400"></div>
    </div>
  </div>

  <script>
    const token = "PASTE_YOUR_ACCESS_TOKEN_HERE"; // ‚Üê Replace with yours

    async function fetchNowPlaying() {
      const res = await fetch("https://api.spotify.com/v1/me/player/currently-playing", {
        headers: { Authorization: `Bearer ${token}` }
      });

      if (res.status === 204) return null; // nothing playing
      if (!res.ok) throw new Error("Spotify error");

      return res.json();
    }

    async function render() {
      try {
        const data = await fetchNowPlaying();

        if (!data || !data.item) {
          document.getElementById("track").textContent = "Nothing playing";
          document.getElementById("artist").textContent = "";
          document.getElementById("state").textContent = "";
          document.getElementById("art").src = "https://via.placeholder.com/80?text=üéµ";
          return;
        }

        document.getElementById("art").src = data.item.album.images?.[0]?.url || "";
        document.getElementById("track").textContent = data.item.name;
        document.getElementById("artist").textContent = data.item.artists.map(a => a.name).join(", ");
        document.getElementById("state").textContent = data.is_playing ? "‚ñ∂Ô∏è Playing" : "‚è∏Ô∏è Paused";
      } catch (err) {
        document.getElementById("track").textContent = "Error loading song";
        console.error(err);
      }
    }

    render();
    setInterval(render, 15000);
  </script>
</body>
</html>
